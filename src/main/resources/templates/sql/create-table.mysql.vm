-- See https://dev.mysql.com/doc/refman/8.0/en/create-table.html
-- See https://dev.mysql.com/doc/refman/8.0/en/data-types.html
-- See $request.prettyTemplateName
##
SET sql_mode='ANSI_QUOTES';

-- TODO: add a USE <dbname> statement here
#foreach ($entity in $entities)

-- Entity: ${entity.pkg.value}.${entity.name.upperCamel}
-- PK column count: ${entity.primaryKeyFields.size()}
-- Columns count: ${entity.fields.size()}
CREATE TABLE IF NOT EXISTS ${entity.dbSchemaPrefix}${entity.name.lowerSnake}
(
  #foreach( $field in $entity.primaryKeyFields )
    ##TODO: fix types
    ${field.postgresqlColumnDefinition}#if ($foreach.hasNext || $entity.hasNonPrimaryKeyFields),#end
  #end
  #foreach( $field in $entity.nonPrimaryKeyFields )
    ${field.postgresqlColumnDefinition}#if ($foreach.hasNext),#end
  #end
  ##
  #if ($entity.hasPrimaryKeyFields)
  ,
    $entity.primaryKeyTableConstraint
  #end
  ##TODO: unique constraints
  ##TODO: check constraints
);
#end
